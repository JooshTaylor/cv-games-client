(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(t,e,n){},116:function(t,e,n){},117:function(t,e,n){"use strict";n.r(e);var r,c=n(1),s=n.n(c),o=n(57),a=n.n(o),i=n(20),l=n.n(i),u=n(58),d=s.a.createContext(null),b=(n(110),n(14)),j=n(3),f=n(2);!function(t){t.WaitingForPlayers="WaitingForPlayers",t.InProgress="InProgress",t.Complete="Complete"}(r||(r={}));var h=n(30),O=function(t){var e=t.url,n=t.method,r=void 0===n?"get":n,c=t.body,s=t.onSuccess,o=t.onError,a={method:r,url:e,cancelToken:l.a.CancelToken.source().token};c&&(a.data=c),l()(a).then((function(t){s&&s(t.data)})).catch((function(t){o&&o(t)}))},x=function(t){s.a.useEffect((function(){if(t){var e=Object(h.a)(Object(h.a)({},t),{},{onSuccess:function(e){t.onSuccess&&t.onSuccess(e)},onError:function(e){t.onError&&t.onError(e)}});O(e)}}),[null===t||void 0===t?void 0:t.url,null===t||void 0===t?void 0:t.method])},m=n(0);function p(){var t=Object(j.i)(),e=Object(j.g)(),n=s.a.useState(null),c=Object(f.a)(n,2),o=c[0],a=c[1];if(x({url:"/telestrations/lobby/".concat(t.id),onSuccess:a,onError:function(){return e.push("/telestrations")}}),!(null===o||void 0===o?void 0:o.id))return Object(m.jsx)(m.Fragment,{});switch(o.status){case r.WaitingForPlayers:return Object(m.jsx)(j.a,{to:"/telestrations/".concat(t.id,"/lobby")});case r.InProgress:return Object(m.jsx)(j.a,{to:"/telestrations/".concat(t.id,"/play")});case r.Complete:return Object(m.jsx)(j.a,{to:"/telestrations/".concat(t.id,"/results")});default:return Object(m.jsx)(j.a,{to:"/telestrations"})}}var v="telestrations:join:lobby",g="telestrations:starting:game",y="telestrations:start:game",S="telestrations:update:lobby",w={getPlayerForLobby:function(t){var e=window.sessionStorage.getItem("account:".concat(t));return"string"===typeof e?JSON.parse(e):null},setPlayerForLobby:function(t,e){w.clearPlayer(t),window.sessionStorage.setItem("account:".concat(t),JSON.stringify(e))},clearPlayer:function(t){window.sessionStorage.removeItem("account:".concat(t))}};function N(){var t,e=Object(j.i)(),n=Object(j.g)(),c=s.a.useState(null),o=Object(f.a)(c,2),a=o[0],i=o[1],l=s.a.useState(null),u=Object(f.a)(l,2),b=u[0],h=u[1],p=s.a.useState(!1),N=Object(f.a)(p,2),W=N[0],F=N[1],P=s.a.useContext(d),C=w.getPlayerForLobby(null===a||void 0===a?void 0:a.id);x({url:"/telestrations/lobby/".concat(e.id),onSuccess:i,onError:function(){return n.push("/telestrations")}}),x({url:"/accounts",onSuccess:h});var E=null!==(t=null===b||void 0===b?void 0:b.filter((function(t){var e;return!(null===a||void 0===a||null===(e=a.players)||void 0===e?void 0:e.find((function(e){return e.id===t.id})))})))&&void 0!==t?t:[],R=function(t){if(a){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];P.emit.apply(P,[t,a.id].concat(n))}};function k(t){O({url:"/telestrations/lobby/".concat(a.id,"/players"),method:"put",body:t,onSuccess:function(t){i(t),R(S)}})}return s.a.useEffect((function(){if(P.id)return P.on(g,(function(){return F(!0)})),P.on(S,i),function(){P.off(g),P.off(S)}}),[P]),s.a.useEffect((function(){if(P.id&&(null===a||void 0===a?void 0:a.id))return P.emit(v,a.id),P.on(y,(function(){n.push("/telestrations/".concat(a.id,"/play"))})),function(){P.off(y)}}),[P,null===a||void 0===a?void 0:a.id]),a&&b?a.status!==r.WaitingForPlayers?Object(m.jsx)(j.a,{to:"/telestrations/".concat(a.id)}):Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"Waiting Room"}),Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-6",children:[Object(m.jsx)("h2",{children:"Select an account"}),Object(m.jsx)("ul",{className:"list-unstyled d-flex align-items-center flex-wrap",children:E.map((function(t){return Object(m.jsx)("li",{children:Object(m.jsx)("button",{className:"btn btn-link",onClick:function(){return function(t){var e=[t];C&&e.push(C),w.setPlayerForLobby(a.id,t),k(e)}(t)},children:t.username})},t.id)}))})]}),Object(m.jsxs)("div",{className:"col-6",children:[Object(m.jsx)("h2",{children:"Players"}),Object(m.jsx)("ul",{className:"list-unstyled d-flex align-items-center flex-wrap",children:a.players.map((function(t){return Object(m.jsx)("li",{children:Object(m.jsx)("button",{className:"btn btn-link",onClick:function(){return function(t){C&&C.id===t.id&&(w.clearPlayer(a.id),k([t]))}(t)},children:t.username})},t.id)}))})]})]}),Object(m.jsx)("div",{children:Object(m.jsx)("button",{onClick:function(){a&&(R(g),O({url:"/telestrations/lobby/".concat(a.id,"/start"),method:"post"}))},className:"btn btn-primary",disabled:W,children:"Start Game"})})]}):Object(m.jsx)(m.Fragment,{})}var W;n(116);function F(t){var e=s.a.useRef(null),n=s.a.useState(!1),r=Object(f.a)(n,2),c=r[0],o=r[1],a=s.a.useState(0),i=Object(f.a)(a,2),l=i[0],u=i[1],d=s.a.useState(0),b=Object(f.a)(d,2),j=b[0],h=b[1],O=s.a.useState(1),x=Object(f.a)(O,2),p=x[0],v=x[1],g=s.a.useState(!1),y=Object(f.a)(g,2),S=y[0],w=y[1];return s.a.useEffect((function(){if(e.current){var t=e.current,n=t.getContext("2d");t.width=t.height=600,n.fillRect(0,0,600,600)}}),[e.current]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("h2",{children:["Draw word: ",t.round.word]}),Object(m.jsx)("canvas",{id:"canvas",height:"600",width:"600",ref:e,onMouseDown:function(t){if(e.current&&!S){var n=e.current.getContext("2d");o(!0),n.fillStyle="#ffffff",u(t.pageX-e.current.offsetLeft),h(t.pageY-e.current.offsetTop)}},onMouseMove:function(t){if(e.current&&!S){var n=e.current.getContext("2d");if(c){var r=t.pageX-e.current.offsetLeft,s=t.pageY-e.current.offsetTop,o=r,a=l,i=s,d=j,b=Math.abs(d-i)>Math.abs(a-o);if(b){var f=o;o=i,i=f;var O=d;d=a,a=O}if(o>a){var x=o;o=a,a=x;var m=i;i=d,d=m}var g=a-o,y=0,w=Math.abs(d-i)/g,N=-1,W=i;i<d&&(N=1);var F=5-Math.sqrt((a-o)*(a-o)+(d-i)*(d-i))/10;F<1&&(F=1);for(var P=o;P<a;P++)b?n.fillRect(W,P,p,p):n.fillRect(P,W,p,p),(y+=w)>=.5&&(W+=N,y-=1);u(r),h(s),v(F)}}},onMouseUp:function(t){S||o(!1)}}),Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(n){n.preventDefault(),e.current&&(w(!0),t.onSubmitDrawing(e.current.toDataURL()))},children:"Submit Drawing"})})]})}function P(t){var e,n=s.a.useState(!!t.round.word),r=Object(f.a)(n,2),c=r[0],o=r[1],a=s.a.useState(null!==(e=t.round.word)&&void 0!==e?e:""),i=Object(f.a)(a,2),l=i[0],u=i[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{children:c?Object(m.jsx)(m.Fragment,{children:"Guess submitted! Waiting for other players..."}):Object(m.jsx)(m.Fragment,{children:"Guess the title of this drawing!"})}),Object(m.jsx)("img",{alt:"",src:t.round.drawing,style:{width:"600px",height:"600px"}}),Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(!0),t.onGuessWord(l)},children:[Object(m.jsx)("div",{className:"form-group pb-3",children:Object(m.jsx)("input",{className:"form-control",placeholder:"Enter your guess here...",value:l,onChange:function(t){return u(t.target.value)},disabled:c})}),Object(m.jsx)("div",{className:"form-group",children:Object(m.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:c,children:"Submit"})})]})]})}function C(t){var e=s.a.useState(!!t.selectedWord),n=Object(f.a)(e,2),r=n[0],c=n[1],o=s.a.useState(t.selectedWord),a=Object(f.a)(o,2),i=a[0],l=a[1];return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:r?Object(m.jsxs)(m.Fragment,{children:['Your word is "',i,'"! Waiting for other players...']}):Object(m.jsx)(m.Fragment,{children:"Select your word"})}),Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c(!0),t.onSelectWord(i)},children:[Object(m.jsx)("div",{className:"form-group pb-3",children:Object(m.jsx)("input",{className:"form-control",placeholder:"Enter your word...",value:i,onChange:function(t){return l(t.target.value)},disabled:r})}),Object(m.jsx)("div",{className:"form-group",children:Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:r,children:"Submit"})})]})]})}function E(){var t=Object(j.i)(),e=Object(j.g)(),n=w.getPlayerForLobby(t.id),c=s.a.useState(null),o=Object(f.a)(c,2),a=o[0],i=o[1],l=s.a.useState(),u=Object(f.a)(l,2),b=u[0],h=u[1],p=s.a.useState(null),v=Object(f.a)(p,2),g=v[0],y=v[1],N=s.a.useContext(d);if(x({url:"/telestrations/lobby/".concat(t.id),onSuccess:i,onError:function(){return e.push("/telestrations")}}),x({url:"/telestrations/lobby/".concat(t.id,"/players/").concat(n.id,"/word"),onSuccess:h,onError:function(){return h("")}}),x(a&&{url:"/telestrations/lobby/".concat(a.id,"/round/").concat(a.currentRound,"?playerId=").concat(n.id),onSuccess:y}),s.a.useEffect((function(){if(N.id)return N.on(S,i),function(){N.off(S)}}),[N]),!g)return Object(m.jsx)(m.Fragment,{});if(a.status!==r.InProgress)return Object(m.jsx)(j.a,{to:"/telestrations/".concat(a.id)});switch(g.roundType){case W.SelectWord:return void 0===b?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(C,{onSelectWord:function(e){h(e),O({url:"/telestrations/lobby/".concat(t.id,"/players/").concat(n.id,"/word"),method:"post",body:{word:e}})},selectedWord:b});case W.DrawWord:return Object(m.jsx)(F,{round:g,onSubmitDrawing:function(e){O({url:"/telestrations/lobby/".concat(t.id,"/players/").concat(n.id,"/round/").concat(a.currentRound,"/drawing"),method:"post",body:{drawing:e}})}});case W.GuessWord:return Object(m.jsx)(P,{round:g,onGuessWord:function(e){O({url:"/telestrations/lobby/".concat(t.id,"/players/").concat(n.id,"/round/").concat(a.currentRound,"/guess"),method:"post",body:{guess:e}})}});default:return Object(m.jsx)(j.a,{to:"/telestrations/".concat(a.id)})}}function R(){var t,e=Object(j.i)(),n=Object(j.g)(),c=null!==(t=new URLSearchParams(Object(j.h)().search).get("playerId"))&&void 0!==t?t:w.getPlayerForLobby(e.id).id,o=s.a.useState(null),a=Object(f.a)(o,2),i=a[0],l=a[1],u=s.a.useState(null),d=Object(f.a)(u,2),b=d[0],h=d[1];return x({url:"/telestrations/lobby/".concat(e.id),onSuccess:l,onError:function(){return n.push("/telestrations")}}),x(i&&{url:"/telestrations/lobby/".concat(e.id,"/players/").concat(c,"/results"),onSuccess:h}),i?i.status!==r.Complete?Object(m.jsx)(j.a,{to:"/telestrations/".concat(i.id)}):b?Object(m.jsxs)("div",{children:[Object(m.jsxs)("h1",{children:["Showing results for: ",b.player.username]}),Object(m.jsxs)("p",{className:"h6",children:["Your original word was: ",b.word]}),b.finalRound.roundType===W.DrawWord?Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:"Here's the final drawing:"}),Object(m.jsx)("img",{alt:"",src:b.finalRound.drawing})]}):Object(m.jsx)("div",{children:Object(m.jsxs)("p",{children:["The final guess for this word was: ",b.finalRound.word]})})]}):Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(m.Fragment,{})}function k(){var t=Object(j.g)();return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"Telestrations"}),Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-6",children:[Object(m.jsx)("h2",{className:"h5",children:"Start a new lobby"}),Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){O({url:"/telestrations/lobby",method:"post",onSuccess:function(e){return t.push("/telestrations/".concat(e.id,"/lobby"))}})},children:"Create Lobby"})]}),Object(m.jsx)("div",{className:"col-6",children:Object(m.jsx)("h2",{className:"h5",children:"Join a game"})})]})]})}function D(){var t=Object(j.j)();return Object(m.jsx)("div",{children:Object(m.jsxs)(j.d,{children:[Object(m.jsx)(j.b,{path:"".concat(t.path,"/:id/lobby"),children:Object(m.jsx)(N,{})}),Object(m.jsx)(j.b,{path:"".concat(t.path,"/:id/play"),children:Object(m.jsx)(E,{})}),Object(m.jsx)(j.b,{path:"".concat(t.path,"/:id/results"),children:Object(m.jsx)(R,{})}),Object(m.jsx)(j.b,{path:"".concat(t.path,"/:id"),children:Object(m.jsx)(p,{})}),Object(m.jsx)(j.b,{path:t.path,children:Object(m.jsx)(k,{})})]})})}function L(){return Object(m.jsx)("div",{className:"container-fluid",children:Object(m.jsx)(b.a,{children:Object(m.jsxs)(j.d,{children:[Object(m.jsx)(j.b,{path:"/telestrations",children:Object(m.jsx)(D,{})}),Object(m.jsx)(j.b,{path:"/",children:Object(m.jsx)(D,{})})]})})})}!function(t){t.SelectWord="SelectWord",t.DrawWord="DrawWord",t.GuessWord="GuessWord"}(W||(W={}));var I="https://cv-games-api.herokuapp.com";l.a.defaults.baseURL="".concat(I,"/api");var M=Object(u.io)(I);M.on("connect",(function(){a.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(d.Provider,{value:M,children:Object(m.jsx)(L,{})})}),document.getElementById("root"))}))}},[[117,1,2]]]);
//# sourceMappingURL=main.be97400c.chunk.js.map